<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>加载状态和错误处理UI测试</title>
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer">
    <style>
        .test-section {
            padding: 2rem;
            margin: 2rem 0;
            border: 1px solid var(--color-border);
            border-radius: var(--radius-lg);
            background: var(--color-bg-secondary);
        }
        
        .test-title {
            font-size: var(--text-xl);
            font-weight: var(--font-bold);
            margin-bottom: 1rem;
            color: var(--color-text-primary);
        }
        
        .test-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            margin-bottom: 2rem;
        }
        
        .test-container {
            min-height: 300px;
            border: 1px dashed var(--color-border);
            border-radius: var(--radius-md);
            background: var(--color-bg-primary);
        }
        
        .posts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            padding: 1rem;
        }
    </style>
</head>
<body>
    <div class="container" style="max-width: 1200px; margin: 2rem auto;">
        <h1 style="text-align: center; margin-bottom: 2rem;">加载状态和错误处理UI测试</h1>
        
        <!-- 骨架屏测试 -->
        <div class="test-section">
            <h2 class="test-title">1. 骨架屏组件测试</h2>
            <div class="test-buttons">
                <button class="btn btn-primary" onclick="showSkeletonTest()">显示骨架屏</button>
                <button class="btn btn-secondary" onclick="clearTestContainer()">清空</button>
            </div>
            <div class="test-container">
                <div class="posts-grid" id="skeleton-test-container">
                    <p style="text-align: center; color: var(--color-text-secondary); margin: 2rem;">点击按钮测试骨架屏效果</p>
                </div>
            </div>
        </div>
        
        <!-- 错误状态测试 -->
        <div class="test-section">
            <h2 class="test-title">2. 错误状态组件测试</h2>
            <div class="test-buttons">
                <button class="btn btn-primary" onclick="showErrorTest()">显示错误状态</button>
                <button class="btn btn-primary" onclick="showNetworkErrorTest()">显示网络错误</button>
                <button class="btn btn-primary" onclick="showPermissionErrorTest()">显示权限错误</button>
                <button class="btn btn-secondary" onclick="clearTestContainer()">清空</button>
            </div>
            <div class="test-container" id="error-test-container">
                <p style="text-align: center; color: var(--color-text-secondary); margin: 2rem;">点击按钮测试错误状态效果</p>
            </div>
        </div>
        
        <!-- 空状态测试 -->
        <div class="test-section">
            <h2 class="test-title">3. 空状态组件测试</h2>
            <div class="test-buttons">
                <button class="btn btn-primary" onclick="showEmptyTest()">显示空状态</button>
                <button class="btn btn-primary" onclick="showEmptyWithActionTest()">显示带操作的空状态</button>
                <button class="btn btn-secondary" onclick="clearTestContainer()">清空</button>
            </div>
            <div class="test-container" id="empty-test-container">
                <p style="text-align: center; color: var(--color-text-secondary); margin: 2rem;">点击按钮测试空状态效果</p>
            </div>
        </div>
        
        <!-- 网络状态测试 -->
        <div class="test-section">
            <h2 class="test-title">4. 网络状态和离线模式测试</h2>
            <div class="test-buttons">
                <button class="btn btn-primary" onclick="showOfflineTest()">显示离线状态</button>
                <button class="btn btn-success" onclick="showOnlineTest()">显示在线状态</button>
                <button class="btn btn-warning" onclick="showOfflineModalTest()">显示离线模态框</button>
                <button class="btn btn-info" onclick="showReconnectTest()">显示重连指示器</button>
                <button class="btn btn-secondary" onclick="hideAllNetworkTests()">隐藏所有</button>
            </div>
            <p style="color: var(--color-text-secondary);">这些组件会显示在页面的固定位置</p>
        </div>
        
        <!-- 提示消息测试 -->
        <div class="test-section">
            <h2 class="test-title">5. 提示消息测试</h2>
            <div class="test-buttons">
                <button class="btn btn-primary" onclick="showLoadingToastTest()">显示加载提示</button>
                <button class="btn btn-success" onclick="showSuccessToastTest()">显示成功提示</button>
                <button class="btn btn-danger" onclick="showErrorToastTest()">显示错误提示</button>
                <button class="btn btn-secondary" onclick="hideLoadingToastTest()">隐藏加载提示</button>
            </div>
            <p style="color: var(--color-text-secondary);">提示消息会显示在页面的固定位置</p>
        </div>
        
        <!-- 重试按钮测试 -->
        <div class="test-section">
            <h2 class="test-title">6. 重试按钮测试</h2>
            <div class="test-buttons">
                <button class="retry-btn" onclick="testRetryButton(this)">
                    <span class="btn-text">
                        <i class="fas fa-redo"></i>
                        重试操作
                    </span>
                    <div class="retry-spinner"></div>
                </button>
            </div>
            <p style="color: var(--color-text-secondary);">点击重试按钮查看加载动画效果</p>
        </div>
    </div>
    
    <!-- 网络状态指示器 -->
    <div class="network-status" id="network-status">
        <div class="network-banner" id="network-banner">
            <div class="network-banner-content">
                <i class="network-icon fas fa-wifi-slash"></i>
                <span class="network-text">网络连接已断开，请检查您的网络设置</span>
            </div>
        </div>
    </div>

    <!-- 离线模式提示 -->
    <div class="offline-overlay" id="offline-overlay">
        <div class="offline-modal">
            <div class="offline-icon">
                <i class="fas fa-cloud-slash"></i>
            </div>
            <h3 class="offline-title">网络连接中断</h3>
            <p class="offline-message">
                看起来您的网络连接出现了问题。请检查网络设置后重试，或者稍后再试。
            </p>
            <div class="error-actions">
                <button class="retry-btn" onclick="hideOfflineModalTest()">
                    <span class="btn-text">
                        <i class="fas fa-redo"></i>
                        重试连接
                    </span>
                    <div class="retry-spinner"></div>
                </button>
                <button class="btn btn-secondary" onclick="hideOfflineModalTest()">
                    <i class="fas fa-times"></i>
                    稍后重试
                </button>
            </div>
        </div>
    </div>

    <!-- 自动重连指示器 -->
    <div class="reconnect-indicator" id="reconnect-indicator">
        <div class="reconnect-spinner"></div>
        <span class="reconnect-text">正在尝试重新连接...</span>
    </div>
    
    <script src="js/loading-error-handler.js"></script>
    <script>
        // 测试函数
        function showSkeletonTest() {
            const container = document.getElementById('skeleton-test-container');
            if (window.loadingErrorHandler) {
                window.loadingErrorHandler.showSkeletonPosts(container, 3);
            }
        }
        
        function showErrorTest() {
            const container = document.getElementById('error-test-container');
            if (window.loadingErrorHandler) {
                window.loadingErrorHandler.showErrorState(
                    container,
                    '加载失败',
                    '抱歉，内容加载失败。请检查网络连接后重试。',
                    true
                );
            }
        }
        
        function showNetworkErrorTest() {
            const container = document.getElementById('error-test-container');
            if (window.loadingErrorHandler) {
                window.loadingErrorHandler.showErrorState(
                    container,
                    '网络连接失败',
                    '无法连接到服务器，请检查您的网络连接。',
                    true
                );
            }
        }
        
        function showPermissionErrorTest() {
            const container = document.getElementById('error-test-container');
            if (window.loadingErrorHandler) {
                window.loadingErrorHandler.showErrorState(
                    container,
                    '权限不足',
                    '抱歉，您没有权限访问这些内容。',
                    false
                );
            }
        }
        
        function showEmptyTest() {
            const container = document.getElementById('empty-test-container');
            if (window.loadingErrorHandler) {
                window.loadingErrorHandler.showEmptyState(
                    container,
                    '暂无内容',
                    '这里还没有任何内容，稍后再来看看吧。',
                    false
                );
            }
        }
        
        function showEmptyWithActionTest() {
            const container = document.getElementById('empty-test-container');
            if (window.loadingErrorHandler) {
                window.loadingErrorHandler.showEmptyState(
                    container,
                    '暂无文章',
                    '还没有发布任何文章，点击下方按钮刷新页面。',
                    true
                );
            }
        }
        
        function showOfflineTest() {
            const networkStatus = document.getElementById('network-status');
            const networkBanner = document.getElementById('network-banner');
            
            networkBanner.classList.remove('online');
            networkBanner.querySelector('.network-icon').className = 'network-icon fas fa-wifi-slash';
            networkBanner.querySelector('.network-text').textContent = '网络连接已断开，请检查您的网络设置';
            networkStatus.classList.add('show');
        }
        
        function showOnlineTest() {
            const networkStatus = document.getElementById('network-status');
            const networkBanner = document.getElementById('network-banner');
            
            networkBanner.classList.add('online');
            networkBanner.querySelector('.network-icon').className = 'network-icon fas fa-wifi';
            networkBanner.querySelector('.network-text').textContent = '网络连接已恢复';
            networkStatus.classList.add('show');
            
            // 3秒后自动隐藏
            setTimeout(() => {
                networkStatus.classList.remove('show');
            }, 3000);
        }
        
        function showOfflineModalTest() {
            const offlineOverlay = document.getElementById('offline-overlay');
            offlineOverlay.classList.add('show');
            document.body.style.overflow = 'hidden';
        }
        
        function hideOfflineModalTest() {
            const offlineOverlay = document.getElementById('offline-overlay');
            offlineOverlay.classList.remove('show');
            document.body.style.overflow = 'auto';
        }
        
        function showReconnectTest() {
            const reconnectIndicator = document.getElementById('reconnect-indicator');
            reconnectIndicator.classList.add('show');
            
            // 5秒后自动隐藏
            setTimeout(() => {
                reconnectIndicator.classList.remove('show');
            }, 5000);
        }
        
        function hideAllNetworkTests() {
            document.getElementById('network-status').classList.remove('show');
            document.getElementById('offline-overlay').classList.remove('show');
            document.getElementById('reconnect-indicator').classList.remove('show');
            document.body.style.overflow = 'auto';
        }
        
        function showLoadingToastTest() {
            if (window.loadingErrorHandler) {
                window.loadingErrorHandler.showLoadingToast('正在处理您的请求...');
            }
        }
        
        function hideLoadingToastTest() {
            if (window.loadingErrorHandler) {
                window.loadingErrorHandler.hideLoadingToast();
            }
        }
        
        function showSuccessToastTest() {
            if (window.loadingErrorHandler) {
                window.loadingErrorHandler.showSuccessToast('操作成功完成！');
            }
        }
        
        function showErrorToastTest() {
            if (window.loadingErrorHandler) {
                window.loadingErrorHandler.showErrorToast('操作失败，请重试');
            }
        }
        
        function testRetryButton(btn) {
            btn.classList.add('loading');
            btn.disabled = true;
            
            // 模拟异步操作
            setTimeout(() => {
                btn.classList.remove('loading');
                btn.disabled = false;
                
                if (window.loadingErrorHandler) {
                    window.loadingErrorHandler.showSuccessToast('重试成功！');
                }
            }, 2000);
        }
        
        function clearTestContainer() {
            document.getElementById('skeleton-test-container').innerHTML = '<p style="text-align: center; color: var(--color-text-secondary); margin: 2rem;">点击按钮测试骨架屏效果</p>';
            document.getElementById('error-test-container').innerHTML = '<p style="text-align: center; color: var(--color-text-secondary); margin: 2rem;">点击按钮测试错误状态效果</p>';
            document.getElementById('empty-test-container').innerHTML = '<p style="text-align: center; color: var(--color-text-secondary); margin: 2rem;">点击按钮测试空状态效果</p>';
        }
    </script>
</body>
</html>